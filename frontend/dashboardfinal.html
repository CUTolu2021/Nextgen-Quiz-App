<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quizzy Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <style>
        .wave {
            animation: wave-animation 2s infinite;
            transform-origin: 70% 70%;
            display: inline-block;
        }

        @keyframes wave-animation {
            0% { transform: rotate( 0.0deg) }
            10% { transform: rotate(14.0deg) }
            20% { transform: rotate(-8.0deg) }
            30% { transform: rotate(14.0deg) }
            40% { transform: rotate(-4.0deg) }
            50% { transform: rotate(10.0deg) }
            60% { transform: rotate( 0.0deg) }
            100% { transform: rotate( 0.0deg) }
        }
    </style>
    <script src="authentication.js"></script>
</head>
<body class="bg-purple-50">
    <header class="bg-white shadow-md p-4 flex justify-between items-center">
        <div class="flex items-center space-x-2">
            <div class="bg-purple-600 p-2 rounded-full">
                <i class="fas fa-question text-white"></i>
            </div>
            <h1 class="text-purple-600 text-xl font-bold">QUIZZY</h1>
        </div>
        <div class="flex items-center space-x-4">
            <div class="relative">
                <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-600"></i>
                <input id="search-input" type="text" placeholder="Search quizzes..." class="pl-10 p-2 rounded-md border border-gray-300">
            </div>
            <i id="notification-icon" class="fas fa-bell text-gray-600 cursor-pointer"></i>
            <i id="settings-icon" class="fas fa-cog text-gray-600 cursor-pointer"></i>
            <div class="bg-purple-600 p-2 rounded-full">
                <span class="text-white">UN</span>
            </div>
        </div>
    </header>
    <main class="p-6">
        <div class="bg-purple-100 p-6 rounded-lg mb-6">
            <div class="flex justify-between items-center">
                <div>
                    <h2 class="text-2xl font-bold">Welcome back, Uchechukwu! <span class="wave">ðŸ‘‹</span></h2>
                    <p class="text-gray-600">Let's create something amazing today</p>
                </div>
                <div class="flex space-x-4">
                    <button id="create-quiz-btn" class="bg-purple-600 text-white px-4 py-2 rounded-md">+ Create New Quiz</button>
                    <button id="upload-quiz-btn" class="bg-white text-purple-600 border border-purple-600 px-4 py-2 rounded-md">
                        <i class="fa-regular fa-arrow-up-from-bracket mr-2"></i>Upload Questions
                    </button>
                </div>
            </div>
        </div>
        <div class="grid grid-cols-1 gap-4 mb-6">
            <div class="bg-white p-4 rounded-lg shadow-md flex justify-between items-center">
                <div>
                    <h3 class="text-gray-600">Total Quizzes</h3>
                    <p class="text-2xl font-bold">24</p>
                </div>
                <div class="bg-purple-100 p-2 rounded-full">
                    <i class="fas fa-cogs text-purple-600"></i>
                </div>
            </div>
            <div class="bg-white p-4 rounded-lg shadow-md flex justify-between items-center">
                <div>
                    <h3 class="text-gray-600">Active players</h3>
                    <p class="text-2xl font-bold">1.2k</p>
                </div>
                <div class="bg-purple-100 p-2 rounded-full">
                    <i class="fas fa-users text-purple-600"></i>
                </div>
            </div>
            <div class="bg-white p-4 rounded-lg shadow-md flex justify-between items-center">
                <div>
                    <h3 class="text-gray-600">Completion Rate</h3>
                    <p class="text-2xl font-bold">78%</p>
                </div>
                <div class="bg-purple-100 p-2 rounded-full">
                    <i class="fas fa-trophy text-purple-600"></i>
                </div>
            </div>
            <div class="bg-white p-4 rounded-lg shadow-md flex justify-between items-center">
                <div>
                    <h3 class="text-gray-600">Avg. Score</h3>
                    <p class="text-2xl font-bold">82%</p>
                </div>
                <div class="bg-purple-100 p-2 rounded-full">
                    <i class="fas fa-chart-line text-purple-600"></i>
                </div>
            </div>
        </div>
        <div class="bg-purple-100 p-6 rounded-lg mb-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold">Recent Quizzes</h3>
                <a id="view-all-link" href="#" class="text-purple-600">View All</a>
            </div>
            <div class="flex space-x-4 mb-4">
                <button id="all-quizzes-btn" class="bg-purple-600 text-white px-4 py-2 rounded-md">All Quizzes</button>
                <button id="general-questions-btn" class="bg-white text-gray-600 border border-gray-300 px-4 py-2 rounded-md">General Questions</button>
                <button id="fun-trivia-btn" class="bg-white text-gray-600 border border-gray-300 px-4 py-2 rounded-md">Fun & Trivia</button>
                <button id="educational-btn" class="bg-white text-gray-600 border border-gray-300 px-4 py-2 rounded-md">Educational</button>
            </div>
            <div id="quizzes-list" class="space-y-4">
                <div class="bg-white p-4 rounded-lg shadow-md flex justify-between items-center">
                    <div>
                        <h4 class="text-lg font-bold">Geography Quiz</h4>
                        <p class="text-gray-600">Participants: 80</p>
                    </div>
                    <div class="text-gray-600 text-center">
                        <p>Avg. Score: 78%</p>
                    </div>
                    <div class="text-gray-600">
                        <p>Time: 30mins</p>
                    </div>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-md flex justify-between items-center">
                    <div>
                        <h4 class="text-lg font-bold">Sports Legend Quiz</h4>
                        <p class="text-gray-600">Participants: 120</p>
                    </div>
                    <div class="text-gray-600 text-center">
                        <p>Avg. Score: 82%</p>
                    </div>
                    <div class="text-gray-600">
                        <p>Time: 20mins</p>
                    </div>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-md flex justify-between items-center">
                    <div>
                        <h4 class="text-lg font-bold">Current Events Quiz</h4>
                        <p class="text-gray-600">Participants: 60</p>
                    </div>
                    <div class="text-gray-600 text-center">
                        <p>Avg. Score: 50%</p>
                    </div>
                    <div class="text-gray-600">
                        <p>Time: 60mins</p>
                    </div>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-md flex justify-between items-center">
                    <div>
                        <h4 class="text-lg font-bold">English Language Quiz</h4>
                        <p class="text-gray-600">Participants: 70</p>
                    </div>
                    <div class="text-gray-600 text-center">
                        <p>Avg. Score: 75%</p>
                    </div>
                    <div class="text-gray-600">
                        <p>Time: 30mins</p>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const allQuizzesBtn = document.getElementById('all-quizzes-btn');
            const generalQuestionsBtn = document.getElementById('general-questions-btn');
            const funTriviaBtn = document.getElementById('fun-trivia-btn');
            const educationalBtn = document.getElementById('educational-btn');
            const quizzesList = document.getElementById('quizzes-list');
            const createQuizBtn = document.getElementById('create-quiz-btn');
            const uploadQuizBtn = document.getElementById('upload-quiz-btn');
            const searchIcon = document.getElementById('search-icon');
            const searchInput = document.getElementById('search-input');
            const notificationIcon = document.getElementById('notification-icon');
            const settingsIcon = document.getElementById('settings-icon');
            const viewAllLink = document.getElementById('view-all-link');

            const quizzes = [
                { title: 'Geography Quiz', participants: 80, avgScore: 78, time: '30mins', category: 'general' },
                { title: 'Sports Legend Quiz', participants: 120, avgScore: 82, time: '20mins', category: 'fun' },
                { title: 'Current Events Quiz', participants: 60, avgScore: 50, time: '60mins', category: 'general' },
                { title: 'English Language Quiz', participants: 70, avgScore: 75, time: '30mins', category: 'educational' }
            ];

            const renderQuizzes = (category) => {
                quizzesList.innerHTML = '';
                const filteredQuizzes = category ? quizzes.filter(quiz => quiz.category === category) : quizzes;
                filteredQuizzes.forEach(quiz => {
                    const quizElement = document.createElement('div');
                    quizElement.className = 'bg-white p-4 rounded-lg shadow-md flex justify-between items-center';
                    quizElement.innerHTML = `
                        <div>
                            <h4 class="text-lg font-bold">${quiz.title}</h4>
                            <p class="text-gray-600">Participants: ${quiz.participants}</p>
                        </div>
                        <div class="text-gray-600 text-center">
                            <p>Avg. Score: ${quiz.avgScore}%</p>
                        </div>
                        <div class="text-gray-600">
                            <p>Time: ${quiz.time}</p>
                        </div>
                    `;
                    quizzesList.appendChild(quizElement);
                });
            };

            const handleCategoryClick = (category) => {
                allQuizzesBtn.classList.toggle('bg-purple-600', category === null);
                allQuizzesBtn.classList.toggle('text-white', category === null);
                allQuizzesBtn.classList.toggle('bg-white', category !== null);
                allQuizzesBtn.classList.toggle('text-gray-600', category !== null);

                generalQuestionsBtn.classList.toggle('bg-purple-600', category === 'general');
                generalQuestionsBtn.classList.toggle('text-white', category === 'general');
                generalQuestionsBtn.classList.toggle('bg-white', category !== 'general');
                generalQuestionsBtn.classList.toggle('text-gray-600', category !== 'general');

                funTriviaBtn.classList.toggle('bg-purple-600', category === 'fun');
                funTriviaBtn.classList.toggle('text-white', category === 'fun');
                funTriviaBtn.classList.toggle('bg-white', category !== 'fun');
                funTriviaBtn.classList.toggle('text-gray-600', category !== 'fun');

                educationalBtn.classList.toggle('bg-purple-600', category === 'educational');
                educationalBtn.classList.toggle('text-white', category === 'educational');
                educationalBtn.classList.toggle('bg-white', category !== 'educational');
                educationalBtn.classList.toggle('text-gray-600', category !== 'educational');

                renderQuizzes(category);
            };

            allQuizzesBtn.addEventListener('click', () => handleCategoryClick(null));
            generalQuestionsBtn.addEventListener('click', () => handleCategoryClick('general'));
            funTriviaBtn.addEventListener('click', () => handleCategoryClick('fun'));
            educationalBtn.addEventListener('click', () => handleCategoryClick('educational'));

            createQuizBtn.addEventListener('click', () => {
                window.location.href = 'createQuiz.html';
            });

            uploadQuizBtn.addEventListener('click', async () => {
                const quizId = prompt('Enter the Quiz ID:');
                if (!quizId) return alert('Quiz ID is required.');

                const fileInput = document.createElement('input');
                fileInput.type = 'file';
                fileInput.accept = '.csv';
                fileInput.onchange = async (event) => {
                    const file = event.target.files[0];
                    if (!file) return alert('No file selected.');

                    const formData = new FormData();
                    formData.append('file', file);

                    try {
                        const response = await fetch(`/upload-questions/${quizId}`, {
                            method: 'POST',
                            body: formData
                        });

                        const result = await response.json();
                        if (response.ok) {
                            alert('Questions added successfully');
                        } else {
                            alert(`Failed to upload questions: ${result.message}`);
                        }
                    } catch (error) {
                        console.error('Error uploading questions:', error);
                        alert('An error occurred while uploading questions.');
                    }
                };
                fileInput.click();
            });

            searchIcon.addEventListener('click', () => {
                const query = searchInput.value.toLowerCase();
                const filteredQuizzes = quizzes.filter(quiz => quiz.title.toLowerCase().includes(query));
                quizzesList.innerHTML = '';
                filteredQuizzes.forEach(quiz => {
                    const quizElement = document.createElement('div');
                    quizElement.className = 'bg-white p-4 rounded-lg shadow-md flex justify-between items-center';
                    quizElement.innerHTML = `
                        <div>
                            <h4 class="text-lg font-bold">${quiz.title}</h4>
                            <p class="text-gray-600">Participants: ${quiz.participants}</p>
                        </div>
                        <div class="text-gray-600 text-center">
                            <p>Avg. Score: ${quiz.avgScore}%</p>
                        </div>
                        <div class="text-gray-600">
                            <p>Time: ${quiz.time}</p>
                        </div>
                    `;
                    quizzesList.appendChild(quizElement);
                });
            });

            notificationIcon.addEventListener('click', () => {
                const receiveNotifications = confirm('Do you want to receive notifications?');
                if (receiveNotifications) {
                    alert('You will receive notifications.');
                } else {
                    alert('You will not receive notifications.');
                }
            });

            settingsIcon.addEventListener('click', () => {
                window.location.href = '/settings';
            });

            viewAllLink.addEventListener('click', () => {
                window.location.href = '/all-quizzes';
            });

            renderQuizzes(null);
        });
    </script>
</body>
</html>